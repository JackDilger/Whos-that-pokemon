<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Who's that Pokémon?</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
        button {
        color: #090029; /* Set the desired text color */
        -webkit-appearance: none; /* Remove default button styles in Safari/Chrome */
        -moz-appearance: none; /* Remove default button styles in Firefox */
        appearance: none; /* Standardize across all browsers */
        outline: none; /* Remove focus outline */
        text-decoration: none; /* Remove text underline or decoration */
        }

        button:focus {
        color: #090029; /* Ensure focus doesn't change the color */
        }

        button:active {
        color: #090029; /* Ensure the active state doesn't change the color */
        }

      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }
      body {
        height: 100vh;
        background: linear-gradient(
          #da2e2c 49%,
          #090029 49%,
          #090029 51%,
          #ffffff 51%
        );
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .start-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }
      .start-button {
        background-color: #ffffff;
        height: 6em;
        width: 6em;
        font-size: 1.8em;
        border: 0.4em solid #090029;
        border-radius: 50%;
        cursor: pointer;
        font-weight: bold;
        color: #090029;
        box-shadow: 0 0 0 0.4em #090029;
        transition: background-color 0.2s ease;
      }
      .start-button:hover {
        background-color: #ffcccc;
      }
      .game-container {
        display: none;
        background-color: #ffffff;
        width: 100%;
        max-width: 31em;
        padding: 3em 1.5em;
        border: 0.6em solid #090029;
        border-radius: 0.5em;
        position: absolute;
        transform: translate(-50%, -50%);
        left: 50%;
        top: 50%;
        text-align: center;
      }
      .timer span {
        font-weight: 600;
      }
      .header {
        text-align: right;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .lives {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5em;
      }
      .lives img {
        width: 40px;
        height: 40px;
        opacity: 1;
        transition: opacity 0.3s ease;
      }
      .lives img.lost {
        opacity: 0.3;
      }
      .lives span {
        font-size: 1.2em;
        font-weight: bold;
        color: #da2e2c;
      }
      .timer-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .timer-container span {
        font-size: 1.2em;
        font-weight: bold;
        color: #da2e2c;
      }
      .pokemon-image {
        display: block;
        margin: 3em auto 0 auto;
        width: 250px;
        height: 250px;
        position: relative;
      }
      #loadingSpinner {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 40px;
        background: url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png') no-repeat center center;
        background-size: contain;
        display: none;
      }

      #loadingSpinner.shaking {
        display: block;
        animation: shake 1s ease-in-out 2;
      }

      @keyframes shake {
        0% {
          transform: translate(-50%, -50%) translateX(0);
        }
        25% {
          transform: translate(-50%, -50%) translateX(-10px);
        }
        50% {
          transform: translate(-50%, -50%) translateX(10px);
        }
        75% {
          transform: translate(-50%, -50%) translateX(-10px);
        }
        100% {
          transform: translate(-50%, -50%) translateX(0);
        }
      }

      input {
        padding: 0.8em;
        font-size: 1.2em;
        width: calc(100% - 3em);
        margin-bottom: 1em;
        border: 0.3em solid #090029;
        border-radius: 0.5em;
        box-shadow: 0 0.5em 0 0 #090029;
      }
      input:focus {
        outline: none;
      }
      button {
        background-color: #ffffff;
        padding: 0.8em;
        border: 0.3em solid #090029;
        border-radius: 0.5em;
        box-shadow: 0 0.5em 0 0 #090029;
        cursor: pointer;
        font-size: 1.2em;
      }
      button:hover {
        box-shadow: none;
        transform: translateY(0.6em);
      }
      button:focus {
        outline: none;
      }
      .hide {
        display: none;
      }
      #result {
        font-size: 1.2em;
        margin-top: 1em;
      }
      #result.correct {
        color: #58cc5d;
      }
      #result.incorrect {
        color: #eb5650;
      }
      #timer {
        font-size: 1.5em;
        font-weight: bold;
        color: #ff0000;
      }
      #score {
        font-size: 1.5em;
        font-weight: bold;
        color: #00ff00;
      }
    </style>
  </head>
  <body>
    <div class="start-container">
      <button class="start-button" id="startGame">Start</button>
    </div>

    <div class="game-container">
      <div class="header">
        <div class="lives">
          <span>HP</span>
          <div id="lives"></div>
        </div>
        <div class="timer-container">
          <span>Timer</span>
          <div id="timer">15</div>
        </div>
      </div>
      <div id="loadingSpinner" class="hide"></div>
      <img
        id="pokemonImage"
        class="pokemon-image"
        src=""
        alt="Who's that Pokémon?"
      />
      <input type="text" id="guess" placeholder="Enter Pokémon name" />
      <button id="submitGuess">Submit Guess</button>
      <button id="skipButton">Skip</button>
      <p id="result"></p>
      <p>Score: <span id="score">0</span></p>
    </div>

    <script>
      const startButton = document.getElementById("startGame");
      const startContainer = document.querySelector(".start-container");
      const gameContainer = document.querySelector(".game-container");
      const livesElement = document.getElementById("lives");
    
      const imageElement = document.getElementById("pokemonImage");
      const loadingSpinner = document.getElementById("loadingSpinner");
      const guessInput = document.getElementById("guess");
      const submitButton = document.getElementById("submitGuess");
      const skipButton = document.getElementById("skipButton");
      const resultElement = document.getElementById("result");
      const scoreElement = document.getElementById("score");
      const timerElement = document.getElementById("timer");
    
      let pokemonName = "";
      let score = 0;
      let timer = 15;
      let timerInterval;
      let lives = 5;
    
      // Initialize lives display
      function initializeLives() {
        livesElement.innerHTML = "";
        for (let i = 0; i < 5; i++) {
          const life = document.createElement("img");
          life.src = "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png";
          life.alt = "Pokéball";
          livesElement.appendChild(life);
        }
      }
    
      // Decrease a life
      function loseLife() {
        if (lives > 0) {
          lives--;
          const lifeIcons = livesElement.querySelectorAll("img");
          lifeIcons[5 - lives - 1].classList.add("lost");
    
          if (lives === 0) {
            endGame(); // Handle game over
          }
        }
      }
    
      // End the game when lives run out
      function endGame() {
        const playAgain = confirm("Game Over! You've lost all your lives. Would you like to play again?");
        if (playAgain) {
          resetGame();
        } else {
          location.reload(); // Restart the game fully if the user chooses not to play again
        }
      }
    
      // Reset the game state
      function resetGame() {
        score = 0;
        lives = 5;
        timer = 15;
        scoreElement.textContent = score;
        initializeLives();
        showLoadingAndFetchNewPokemon();
      }
    
      startButton.addEventListener("click", () => {
        startContainer.style.display = "none";
        gameContainer.style.display = "block";
        initializeLives(); // Display lives at the start
        showLoadingAndFetchNewPokemon();
      });
    
      // Unified logic for showing the spinner and fetching a new Pokémon
      function showLoadingAndFetchNewPokemon() {
        // Show the spinner and start shaking
        loadingSpinner.classList.add("shaking");
        imageElement.style.visibility = "hidden";
        imageElement.src = ""; // Clear the current image
    
        // Add a delay for the shake animation before fetching a new Pokémon
        setTimeout(() => {
          fetchNewPokemon(() => {
            // Stop shaking only after the new Pokémon has loaded
            loadingSpinner.classList.remove("shaking");
          });
        }, 1500); // Duration of the shake animation
      }
    
      function fetchNewPokemon(callback) {
        const randomId = Math.floor(Math.random() * 150) + 1; // Random Pokémon ID (1-150)
    
        fetch(`https://pokeapi.co/api/v2/pokemon/${randomId}/`)
          .then((response) => response.json())
          .then((data) => {
            pokemonName = data.name.toLowerCase();
    
            // Set new Pokémon image and apply silhouette filter
            imageElement.src = data.sprites.front_default;
            imageElement.style.filter = "brightness(0) saturate(100%)";
            imageElement.style.visibility = "visible"; // Show the new Pokémon
    
            // Trigger callback to stop spinner animation
            if (callback) callback();
          });
    
        // Reset timer for the next round
        timer = 15;
        timerElement.textContent = timer;
    
        // Clear and restart timer interval
        clearInterval(timerInterval);
        startTimer();
      }
    
      function startTimer() {
        timerInterval = setInterval(() => {
          timer--;
          timerElement.textContent = timer;
    
          if (timer === 0) {
            clearInterval(timerInterval);
            loseLife(); // Lose a life on timeout
            resultElement.textContent = `Time's up! The correct answer was ${pokemonName}.`;
            revealPokemon();
            setTimeout(() => {
              resultElement.textContent = ""; // Clear the result text
              showLoadingAndFetchNewPokemon(); // Use the unified transition logic
            }, 1500); // Start a new round after the shake animation
          }
        }, 1000);
      }
    
      function revealPokemon() {
        imageElement.style.filter = "none"; // Reveal the Pokémon
      }
    
      submitButton.addEventListener("click", submitGuessHandler);
      skipButton.addEventListener("click", skipPokemon);
    
      function submitGuessHandler() {
        resultElement.textContent = ""; // Clear any previous result text
        const userGuess = guessInput.value.toLowerCase();
        if (userGuess === pokemonName) {
          score++;
          scoreElement.textContent = score;
          resultElement.textContent = `Correct! It's ${pokemonName}`;
          clearInterval(timerInterval);
          revealPokemon();
          setTimeout(() => {
            resultElement.textContent = ""; // Clear the result text
            showLoadingAndFetchNewPokemon(); // Use the unified transition logic
          }, 1500); // Start a new round after the shake animation
        } else {
          resultElement.textContent = ""; // Clear the text briefly
          setTimeout(() => {
            resultElement.textContent = "Incorrect! Try again."; // Reapply the message
          }, 50); // A slight delay ensures the DOM refreshes
          loseLife(); // Lose a life on wrong guess
        }
        guessInput.value = ""; // Clear input field
      }
    
      function skipPokemon() {
        clearInterval(timerInterval); // Clear the timer for the current Pokémon
        loseLife(); // Reduce a life when skipping
        resultElement.textContent = ""; // Clear result text
        showLoadingAndFetchNewPokemon(); // Use the unified transition logic
      }
    
      guessInput.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          submitGuessHandler();
        }
      });
    </script>
     
  </body>
</html>
